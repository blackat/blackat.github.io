---
layout: single
title: "Angular Piece of Cake"
date: '2018-04-08'
last_modified_at: 2018-04-08
comments: true
categories:
  - Angular
tags:
  - angular
toc: true
toc_label: "on this page"
toc_icon: "list"
toc_sticky: true
---

A _piece of cake_ project to introduce the new Angular framework.

## Angular CLI
The _Angular Command Line Interface_ in one of the great new entries with the new Angular release.

// cool definition of the cli + link

Via the CLI it is possible to effortless perform many tasks such as:
- create a new project along with its scaffolding based on Angular style;
- create a new Angular component;
- run unit tests;
- run and reload the application during development;
- build the application for production;
- `ng help` for more options.

### Install Angular CLI
Angular CLI does not come with Angular installation, it is an optional tool can be installed separtely:
```bash
$ npm install -g @angular/cli
$ ng --version
$ ng --help
```

### Create an application
To create a fresh new application type:
```bash
$ ng new angular-piece-of-cake
$ cd angular-piece-of-cake
```
the tool scaffolds the application along with all the configuration files, this is its layout:
```bash
.
├── README.md
├── docs
├── e2e
├── karma.conf.js
├── node_modules
├── package-lock.json
├── package.json
├── protractor.conf.js
├── src
├── tsconfig.json
└── tslint.json
```
// folder and file description here

{: .notice--warning}
__Watch out!__ Generated project files may differ w.r.t. the version of the Angular CLI.

### Run the application
Type
```bash
$ ng serve
```
and then connect to [http://localhost:4200](http://localhost:4200)

// insert the screenshot of the website

### Build the application for production
// todo: explain what happens with the production, minification etc

Type
```bash
$ ng build --target=production --base-ref /
```

The process will
- build for production environment;
- set the `root` URL of the application;
- make the code available under `dist` folder.

In order to test the project built, install [now](https://zeit.co/now)

```bash
$ npm install -g now
```

and in the dist folder run

```bash
$ now
```

## Project Explained
Focus on the _source folder_ `src\app`

```bash
.
├── app.component.css
├── app.component.html
├── app.component.spec.ts
├── app.component.ts
└── app.module.ts
```

### How-to Bootstrap the Application
Have a look at `app.module.ts`

```typescript
import { NgModule } from '@angular/core';
import { BrowserModule } from '@angular/platform-browser';
import { FormsModule } from '@angular/forms';

import { AppComponent } from './app.component';
import { BlogPostComponent } from './blog-post/blog-post.component';

@NgModule({
  declarations: [
    AppComponent,
    BlogPostComponent
  ],
  imports: [
    BrowserModule,
    FormsModule
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }
```

{: .notice--info}
__Bootstrap!__ The class `AppModule` is decorated with `@NgModule` decorator to tranform the class in a module which, in turn, points to the component to load.
This module will be then bootstrapped in the file `main.ts`.

#### NgModule
This decorator has four properties:
- `import:` used to load a class used later on in the file;
- `imports:` list of module dependencies;
- `providers:` used for dependency injection to make a service available throughout the application;
- `declarations:` declare components before use, like components owned by this module;
- `bootstrap:` component to bootstrap the application.

## Angular Components
Browsers understand a limited set of `tags` or `HTML elements`. They are [well specified](https://developer.mozilla.org/en-US/docs/Web/HTML/Element) as long as the [Web API](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement).

In the Web API an important interface is the [`HTMLElement`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement) that represents a `HTML` element. Each `HTML` element has some properties and a specific function: input field, dropdown etc.

This set of elements is limited, _Angular components_ allows to extend this set and to teach the browser new elements. Components is the new version of AngularJs directives.

### How a component is made
When a new component is created by the `Angular CLI`, it comes along with the controller, the template and the styles.

All the componets a page is made of are organized as a tree: there is always a `root or top-level component` that is bootstrapped by the `app.module.ts` and other components instantiated as in a _chain reaction_.

Let's have a look at first instantiated component, the `top-level component`.

#### The top-level component
Once a component is generated by the Angular CLI, four files are produced as shown below:
```bash
src
  ├── app
  ├── app.component.css
  ├── app.component.html
  ├── app.component.spec.ts
  ├── app.component.ts
  └── app.module.ts
```
`app.component.ts` is the class representing the controller of the component where the logic of the user interaction must go along with the way the component has to be created and destroyed.
Together with the controller there is the _template_ and the _style_ to define the _look-and-feel_ of the component. In the end we have the _test spec_ to unit test the component and ist answer to user interaction.

##### Component class, the controller
```typescript
import { Component } from '@angular/core';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})
export class AppComponent {
  title = 'app';
}
```
This `class` is transformed in a component via the `@Component` decorator that allows to specify:
- `selector`: the name of the new HTML tag;
- ``templateUrl`: the file hodling the HTML template;
- `styleUrls`: an _array_ of styles to be applied to the template.


The module `app.module.ts` will bootstrap the root component and the application will appear to the user.

### Create new component
The fastes way is via the `ng` tool, in a terminal type:
```bash
$ ng generate component hello-form
  create src/app/hello-form/hello-form.component.css
  create src/app/hello-form/hello-form.component.html
  create src/app/hello-form/hello-form.component.spec.ts
  create src/app/hello-form/hello-form.component.ts
  update src/app/app.module.ts (412 bytes)
```
the aforementioned four files are generated, the component then is added to the list of available component in the `app.module.ts`.

#### Template
The template is just a bunch of markup with _special notation keys_ that represents how the template is bound to the controller and viceversa.

```html
<div>
  <label for="currency">Currency:</label>
  <select #currency [(ngModel)]="selectedCurrency" name="currency">
    <option *ngFor="let currency of currencies" [value]="currency">{{currency}}</option>
  </select>
</div>
<div>
  <label for="player">Player:</label>
  <input name="player" #player>
</div>
<button (click)="send(player, currency)">
    Send
</button>
```

/// todo: add <tag>????

The template does not do anything exciting but a `select` element, an `input` filed and a `button`.

##### Select
The `select` element, a.k.a. dropdown, opens when the user click on the flash, display a list of items and closes once of them is selected.

```html
<div>
  <label for="currency">Currency:</label>
  <select #currency [(ngModel)]="selectedCurrency" name="currency">
    <option *ngFor="let currency of currencies" [value]="currency">{{currency}}</option>
  </select>
</div>
```

/// todo: introduce the HTMLInputElement, the DOM etc

Let's see how the template is bound to the controller:
- `#currency`: bind the element to a `HTMLInputElement` object variable called _resolve_;
- `[(ngModel)]="selectedCurrency"`: attach a property to the data model, the variable will hold the selected currency one the dropdown will cloae;
- `<option *ngFor="let currency of currencies" [value]="currency">{{currency}}</option>`: loop over an array repeting the `<option>` element;

##### Input
```html
<div>
  <label for="player">Player:</label>
  <input name="player" #player>
</div>
```

/// todo is it an attribute?

The HTML5 attribute `#player` binds the model behaind the input element to the controller via the _player_ property.

##### Button
```html
<button (click)="send(player, currency)">
    Send
</button>
```

The `(click)` binds the _click event_ to the `send` controller function. As argument of the function there are the two variables previously defined: `#currency` and `#player`.

#### Template wants public properties
All the properties defined in the controller and bound to a template __must be public__ if [AoT](https://angular.io/guide/aot-compiler) has been activated.

<img src=images/rob-wormald-quote.png>

- AoT: convert template code to TypeScript and check binding correctness.
- JiT: transpile code in ES5.
- Template exists <span style="color: #ff6095;">_outside_</span> the component class.
- [Deeper explanation <i class="fab fa-github"></i>](https://github.com/angular/angular/issues/11978)

#### Use the new component
In the template of the _top-level_ component just add the new created tag:
```html
<!-- template tag or mustache tag -->
<h1>{{title}}</h1>

<!-- hello-form component selector -->
<app-hello-form></app-hello-form>
```